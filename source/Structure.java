// Structure object
// 26 September 2018
// Tiana Schwab

public class Structure extends Sequence {
	private String structure;
	private int len;
	private int pos0 = -1;
	private int pos1 = -1;

//#############################################################################
	public Structure (String seq) {
		super (seq);
		this.len = getSequence().length ();
		this.structure = null;
	}
	public Structure (String name, String seq) {
		super (name, seq);
		this.len = getSequence().length ();
		this.structure = null;
	}

//#############################################################################
	
	//set the parameters of the structure object
	public void setStructure (String structure) {
		this.structure = structure;
	}
	public void setPosition (int begin) {
	// set the position of the structure sequence in the whole genome sequence
		this.pos0 = begin;
		this.pos1 = begin+len-1;	
	}
	public void setPosition (int begin, int end) {
	// set the first and last position of the structue in the genome
		if (end+1-begin == len) {	
			this.pos0 = begin;
			this.pos1 = end;
		}
		else {
			System.out.println ("Provided range does not correspond with length of sequence. Only start position was used");
			this.setPosition (begin);
		}
	}
	
	public void findPosition (String genome) {
	// find the position of the sequence in a provided genome
		int gen_len = genome.length();
		for (int i=0; i<gen_len-(len); i++){
			String section = genome.substring(i, i+len);
			if (section.equals (this.getSequence())){	
				this.setPosition (i, i+len-1);
				}
		}
	}
	
	//Access the parameters of the structure objects
	public String getStructure(){
		return this.structure;
	}	
	public int getLength () {
		return this.len;
	}
	public String getPosition () {
		if (pos0 == -1) {
			return ("Position undefined");
		}
		else {
			String begin = Integer.toString (pos0);
			String end = Integer.toString (pos0-1+len);
			return ("Beginning position: "+begin+"\nEnd position: "+end);
		}
	}
	
	public String toString () {
		if (structure == null)
			return getSequence();
		return (getName()+"\n"+getSequence()+"\n"+structure);
	}
//##############################################################################
	public static void main (String[] args) {
			Structure one = new Structure ("UUUCUGCGUCCAACCAGAGAAGGGGGGCCGCAAGCC");
			one.setStructure ("......((((.....(((.......))).........))))....");
			System.out.println (one);
			System.out.println (one.getPosition ());
			String genome = "GCCAGCCCCCGAUUGGGGGCGACACUCCACCAUAGAUCACUCCCCUGUGAGGAACUACUGUCUUCACGCAGAAAGCGUCUAGCCAUGGCGUUAGUAUGAGUGUCGUGCAGCCUCCAGGACCCCCCCUCCCGGGAGAGCCAUAGUGGUCUGCGGAACCGGUGAGUACACCGGAAUUGCCAGGACGACCGGGUCCUUUCUUGGAUCAACCCGCUCAAUGCCUGGAGAUUUGGGCGUGCCCCCGCGAGACUGCUAGCCGAGUAGUGUUGGGUCGCGAAAGGCCUUGUGGUACUGCCUGAUAGGGUGCUugcgagUGCCCCGGGAGGUcucguaGACCGUGCACCAUGAGCACGAAUCCUAAACCUCAAAGAAAAACCAAACGUAACACCAACCGCCGCCCACAGGACGUCAAGUUCCCGGGCGGUGGUCAGAUCGUCGGUGGAGUUUACCUGUUGCCGCGCAGGGGCCCCAGGUUGGGUGUGCGCGCGACUAGGAAGACUUCCGAGCGGUCGCAACCUCGUGGAAGGCGACAACCUAUCCCCAAGGCUCGCCAGCCCGAGGGUAGGGCCUGGGCUCAGCCCGGGUACCCCUGGCCCCUCUAUGGCAAUGAGGGCUUGGGGUGGGCAGGAUGGCUCCUGUCACCCCGUGGCUCUCGGCCUAGUUGGGGCCCCACGGACCCCCGGCGUAGGUCGCGCAAUUUGGGUAAGGUCAUCGAUACCCUCACGUGCGGCUUCGCCGAUCUCAUGGGGUACAUUCCGCUCGUCGGCGCCCCCCUAGGGGGCGCUGCCAGGGCCCUGGCGCAUGGCGUCCGGGUUCUGGAGGACGGCGUGAACUAUGCAACAGGGAAUCUGCCCGGUUGCUCCUUUUCUAUCUUCCUUUUGGCUUUGCUGUCCUGUUUGACCAUCCCAGCUUCCGCUUAUGAAGUGCGCAACGUAUCCGGAGUGUACCAUGUCACGAACGACUGCUCCAACGCAAGCAUUGUGUAUGAGGCAGCGGACAUGAUCAUGCAUACCCCCGGGUGCGUGCCCUGCGUUCGGGAGAACAACUCCUCCCGCUGCUGGGUAGCGCUCACUCCCACGCUCGCGGCCAGGAACGCUAGCGUCCCCACUACGACGAUACGACGCCAUGUCGAUUUGCUCGUUGGGGCGGCUGCUCUCUGCUCCGCUAUGUACGUGGGAGAUCUCUGCGGAUCUGUUUUCCUCGUCGCCCAGCUGUUCACCUUCUCGCCUCGCCGGCACGAGACAGUACAGGACUGCAAUUGCUCAAUAUAUCCCGGCCACGUGACAGGUCACCGUAUGGCUUGGGAUAUGAUGAUGAACUGGUCACCUACAGCAGCCCUAGUGGUAUCGCAGUUACUCCGGAUCCCACAAGCUGUCGUGGAUAUGGUGGCGGGGGCCCAUUGGGGAGUCCUAGCGGGCCUUGCCUACUAUUCCAUGGUGGGGAACUGGGCUAAGGUUCUGAUUGUGAUGCUACUCUUUGCCGGCGUUGACGGGGGAACCUAUGUGACAGGGGGGACGAUGGCCAAAAACACCCUCGGGAUUACGUCCCUCUUUUCACCCGGGUCAUCCCAGAAAAUCCAGCUUGUAAACACCAACGGCAGCUGGCACAUCAACAGGACUGCCCUGAACUGCAAUGACUCCCUCAACACUGGGUUCCUUGCUGCGCUGUUCUACGUGCACAAGUUCAACUCAUCUGGAUGCCCAGAGCGCAUGGCCAGCUGCAGCCCCAUCGACGCGUUCGCUCAGGGGUGGGGGCCCAUCACUUACAAUGAGUCACACAGCUCGGACCAGAGGCCUUAUUGUUGGCACUACGCACCCCGGCCGUGCGGUAUCGUACCCGCGGCGCAGGUGUGUGGUCCAGUGUACUGCUUCACCCCAAGCCCUGUCGUGGUGGGGACGACCGACCGGUUCGGCGUCCCUACGUACAGUUGGGGGGAGAAUGAGACGGACGUGCUGCUUCUUAACAACACGCGGCCGCCGCAAGGCAACUGGUUUGGCUGUACAUGGAUGAAUAGCACUGGGUUCACCAAGACGUGCGGGGGCCCCCCGUGUAACAUCGGGGGGAUCGGCAAUAAAACCUUGACCUGCCCCACGGACUGCUUCCGGAAGCACCCCGAGGCCACUUACACCAAGUGUGGUUCGGGGCCUUGGUUGACACCCAGAUGCUUGGUCCACUACCCAUACAGGCUUUGGCACUACCCCUGCACUGUCAACUUUACCAUCUUCAAGGUUAGGAUGUACGUGGGGGGAGUGGAGCACAGGCUCGAAGCCGCAUGCAAUUGGACUCGAGGAGAGCGUUGUAACCUGGAGGACAGGGACAGAUCAGAGCUUAGCCCGCUGCUGCUGUCUACAACGGAGUGGCAGGUAUUGCCCUGUUCCUUCACCACCCUACCGGCUCUGUCCACUGGUUUGAUCCAUCUCCAUCAGAACGUCGUGGACGUACAAUACCUGUACGGUAUAGGGUCGGCGGUUGUCUCCUUUGCAAUCAAAUGGGAGUAUGUCCUGUUGCUCUUCCUUCUUCUGGCGGACGCGCGCGUCUGUGCCUGCUUGUGGAUGAUGCUGCUGAUAGCUCAAGCUGAGGCCGCCCUAGAGAACCUGGUGGUCCUCAACGCGGCAUCCGUGGCCGGGGCGCAUGGCAUUCUCUCCUUCCUCGUGUUCUUCUGUGCUGCCUGGUACAUCAAGGGCAGGCUGGUCCCUGGGGCGGCAUAUGCCCUCUACGGCGUAUGGCCGCUACUCCUGCUCCUGCUGGCGUUACCACCACGAGCAUACGCCAUGGACCGGGAGAUGGCAGCAUCGUGCGGAGGCGCGGUUUUCGUAGGUCUGAUACUCUUGACCUUGUCACCGCACUAUAAGCUGUUCCUCGCUAGGCUCAUAUGGUGGUUACAAUAUUUUAUCACCAGGGCCGAGGCACACUUGCAAGUGUGGAUCCCCCCCCUCAACGUUCGGGGGGGCCGCGAUGCCGUCAUCCUCCUCACGUGCGCGAUCCACCCAGAGCUAAUCUUUACCAUCACCAAAAUCUUGCUCGCCAUACUCGGUCCACUCAUGGUGCUCCAGGCUGGUAUAACCAAAGUGCCGUACUUCGUGCGCGCACACGGGCUCAUUCGUGCAUGCAUGCUGGUGCGGAAGGUUGCUGGGGGUCAUUAUGUCCAAAUGGCUCUCAUGAAGUUGGCCGCACUGACAGGUACGUACGUUUAUGACCAUCUCACCCCACUGCGGGACUGGGCCCACGCGGGCCUACGAGACCUUGCGGUGGCAGUUGAGCCCGUCGUCUUCUCUGAUAUGGAGACCAAGGUUAUCACCUGGGGGGCAGACACCGCGGCGUGUGGGGACAUCAUCUUGGGCCUGCCCGUCUCCGCCCGCAGGGGGAGGGAGAUACAUCUGGGACCGGCAGACAGCCUUGAAGGGCAGGGGUGGCGACUCCUCGCGCCUAUUACGGCCUACUCCCAACAGACGCGAGGCCUACUUGGCUGCAUCAUCACUAGCCUCACAGGCCGGGACAGGAACCAGGUCGAGGGGGAGGUCCAAGUGGUCUCCACCGCAACACAAUCUUUCCUGGCGACCUGCGUCAAUGGCGUGUGUUGGACUGUCUAUCAUGGUGCCGGCUCAAAGACCCUUGCCGGCCCAAAGGGCCCAAUCACCCAAAUGUACACCAAUGUGGACCAGGACCUCGUCGGCUGGCAAGCGCCCCCCGGGGCGCGUUCCUUGACACCAUGCACCUGCGGCAGCUCGGACCUUUACUUGGUCACGAGGCAUGCCGAUGUCAUUCCGGUGCGCCGGCGGGGCGACAGCAGGGGGAGCCUACUCUCCCCCAGGCCCGUCUCCUACUUGAAGGGCUCUUCGGGCGGUCCACUGCUCUGCCCCUCGGGGCACGCUGUGGGCAUCUUUCGGGCUGCCGUGUGCACCCGAGGGGUUGCGAAGGCGGUGGACUUUGUACCCGUCGAGUCUAUGGAAACCACUAUGCGGUCCCCGGUCUUCACGGACAACUCGUCCCCUCCGGCCGUACCGCAGACAUUCCAGGUGGCCCAUCUACACGCCCCUACUGGUAGCGGCAAGAGCACUAAGGUGCCGGCUGCGUAUGCAGCCCAAGGGUAUAAGGUGCUUGUCCUGAACCCGUCCGUCGCCGCCACCCUAGGUUUCGGGGCGUAUAUGUCUAAGGCACAUGGUAUCGACCCUAACAUCAGAACCGGGGUAAGGACCAUCACCACGGGUGCCCCCAUCACGUACUCCACCUAUGGCAAGUUUCUUGCCGACGGUGGUUGCUCUGGGGGCGCCUAUGACAUCAUAAUAUGUGAUGAGUGCCACUCAACUGACUCGACCACUAUCCUGGGCAUCGGCACAGUCCUGGACCAAGCGGAGACGGCUGGAGCGCGACUCGUCGUGCUCGCCACCGCUACGCCUCCGGGAUCGGUCACCGUGCCACAUCCAAACAUCGAGGAGGUGGCUCUGUCCAGCACUGGAGAAAUCCCCUUUUAUGGCAAAGCCAUCCCCAUCGAGACCAUCAAGGGGGGGAGGCACCUCAUUUUCUGCCAUUCCAAGAAGAAAUGUGAUGAGCUCGCCGCGAAGCUGUCCGGCCUCGGACUCAAUGCUGUAGCAUAUUACCGGGGCCUUGAUGUAUCCGUCAUACCAACUAGCGGAGACGUCAUUGUCGUAGCAACGGACGCUCUAAUGACGGGCUUUACCGGCGAUUUCGACUCAGUGAUCGACUGCAAUACAUGUGUCACCCAGACAGUCGACUUCAGCCUGGACCCGACCUUCACCAUUGAGACGACGACCGUGCCACAAGACGCGGUGUCACGCUCGCAGCGGCGAGGCAGGACUGGUAGGGGCAGGAUGGGCAUUUACAGGUUUGUGACUCCAGGAGAACGGCCCUCGGGCAUGUUCGAUUCCUCGGUUCUGUGCGAGUGCUAUGACGCGGGCUGUGCUUGGUACGAGCUCACGCCCGCCGAGACCUCAGUUAGGUUGCGGGCUUACCUAAACACACCAGGGUUGCCCGUCUGCCAGGACCAUCUGGAGUUCUGGGAGAGCGUCUUUACAGGCCUCACCCACAUAGACGCCCAUUUCUUGUCCCAGACUAAGCAGGCAGGAGACAACUUCCCCUACCUGGUAGCAUACCAGGCUACGGUGUGCGCCAGGGCUCAGGCUCCACCUCCAUCGUGGGACCAAAUGUGGAAGUGUCUCAUACGGCUAAAGCCUACGCUGCACGGGCCAACGCCCCUGCUGUAUAGGCUGGGAGCCGUUCAAAACGAGGUUACUACCACACACCCCAUAACCAAAUACAUCAUGGCAUGCAUGUCGGCUGACCUGGAGGUCGUCACGAGCACCUGGGUGCUGGUAGGCGGAGUCCUAGCAGCUCUGGCCGCGUAUUGCCUGACAACAGGCAGCGUGGUCAUUGUGGGCAGGAUCAUCUUGUCCGGAAAGCCGGCCAUCAUUCCCGACAGGGAAGUCCUUUACCGGGAGUUCGAUGAGAUGGAAGAGUGCGCCUCACACCUCCCUUACAUCGAACAGGGAAUGCAGCUCGCCGAACAAUUCAAACAGAAGGCAAUCGGGUUGCUGCAAACAGCCACCAAGCAAGCGGAGGCUGCUGCUCCCGUGGUGGAAUCCAAGUGGCGGACCCUCGAAGCCUUCUGGGCGAAGCAUAUGUGGAAUUUCAUCAGCGGGAUACAAUAUUUAGCAGGCUUGUCCACUCUGCCUGGCAACCCCGCGAUAGCAUCACUGAUGGCAUUCACAGCCUCUAUCACCAGCCCGCUCACCACCCAACAUACCCUCCUGUUUAACAUCCUGGGGGGAUGGGUGGCCGCCCAACUUGCUCCUCCCAGCGCUGCUUCUGCUUUCGUAGGCGCCGGCAUCGCUGGAGCGGCUGUUGGCAGCAUAGGCCUUGGGAAGGUGCUUGUGGAUAUUUUGGCAGGUUAUGGAGCAGGGGUGGCAGGCGCGCUCGUGGCCUUUAAGGUCAUGAGCGGCGAGAUGCCCUCCACCGAGGACCUGGUUAACCUACUCCCUGCUAUCCUCUCCCCUGGCGCCCUAGUCGUCGGGGUCGUGUGCGCAGCGAUACUGCGUCGGCACGUGGGCCCAGGGGAGGGGGCUGUGCAGUGGAUGAACCGGCUGAUAGCGUUCGCUUCGCGGGGUAACCACGUCUCCCCCACGCACUAUGUGCCUGAGAGCGACGCUGCAGCACGUGUCACUCAGAUCCUCUCUAGUCUUACCAUCACUCAGCUGCUGAAGAGGCUUCACCAGUGGAUCAACGAGGACUGCUCCACGCCAUGCUCCGGCUCGUGGCUAAGAGAUGUUUGGGAUUGGAUAUGCACGGUGUUGACUGAUUUCAAGACCUGGCUCCAGUCCAAGCUCCUGCCGCGAUUGCCGGGAGUCCCCUUCUUCUCAUGUCAACGUGGGUACAAGGGAGUCUGGCGGGGCGACGGCAUCAUGCAAACCACCUGCCCAUGUGGAGCACAGAUCACCGGACAUGUGAAAAACGGUUCCAUGAGGAUCGUGGGGCCUAGGACCUGUAGUAACACGUGGCAUGGAACAUUCCCCAUUAACGCGUACACCACGGGCCCCUGCACGCCCUCCCCGGCGCCAAAUUAUUCUAGGGCGCUGUGGCGGGUGGCUGCUGAGGAGUACGUGGAGGUUACGCGGGUGGGGGAUUUCCACUACGUGACGGGCAUGACCACUGACAACGUAAAGUGCCCGUGUCAGGUUCCGGCCCCCGAAUUCUUCACAGAAGUGGAUGGGGUGCGGUUGCACAGGUACGCUCCAGCGUGCAAACCCCUCCUACGGGAGGAGGUCACAUUCCUGGUCGGGCUCAAUCAAUACCUGGUUGGGUCACAGCUCCCAUGCGAGCCCGAACCGGACGUAGCAGUGCUCACUUCCAUGCUCACCGACCCCUCCCACAUUACGGCGGAGACGGCUAAGCGUAGGCUGGCCAGGGGAUCUCCCCCCUCCUUGGCCAGCUCAUCAGCUAGCCAGCUGUCUGCGCCUUCCUUGAAGGCAACAUGCACUACCCGUCAUGACUCCCCGGACGCUGACCUCAUCGAGGCCAACCUCCUGUGGCGGCAGGAGAUGGGCGGGAACAUCACCCGCGUGGAGUCAGAAAAUAAGGUAGUAAUUUUGGACUCUUUCGAGCCGCUCCAAGCGGAGGAGGAUGAGAGGGAAGUAUCCGUUCCGGCGGAGAUCCUGCGGAGGUCCAGGAAAUUCCCUCGAGCGAUGCCCAUAUGGGCACGCCCGGAUUACAACCCUCCACUGUUAGAGUCCUGGAAGGACCCGGACUACGUCCCUCCAGUGGUACACGGGUGUCCAUUGCCGCCUGCCAAGGCCCCUCCGAUACCACCUCCACGGAGGAAGAGGACGGUUGUCCUGUCAGAAUCUACCGUGUCUUCUGCCUUGGCGGAGCUCGCCACAAAGACCUUCGGCAGCUCCGAAUCGUCGGCCGUCGACAGCGGCACGGCAACGGCCUCUCCUGACCAGCCCUCCGACGACGGCGACGCGGGAUCCGACGUUGAGUCGUACUCCUCCAUGCCCCCCCUUGAGGGGGAGCCGGGGGAUCCCGAUCUCAGCGACGGGUCUUGGUCUACCGUAAGCGAGGAGGCUAGUGAGGACGUCGUCUGCUGCUCGAUGUCCUACACAUGGACAGGCGCCCUGAUCACGCCAUGCGCUGCGGAGGAAACCAAGCUGCCCAUCAAUGCACUGAGCAACUCUUUGCUCCGUCACCACAACUUGGUCUAUGCUACAACAUCUCGCAGCGCAAGCCUGCGGCAGAAGAAGGUCACCUUUGACAGACUGCAGGUCCUGGACGACCACUACCGGGACGUGCUCAAGGAGAUGAAGGCGAAGGCGUCCACAGUUAAGGCUAAACUUCUAUCCGUGGAGGAAGCCUGUAAGCUGACGCCCCCACAUUCGGCCAGAUCUAAAUUUGGCUAUGGGGCAAAGGACGUCCGGAACCUAUCCAGCAAGGCCGUUAACCACAUCCGCUCCGUGUGGAAGGACUUGCUGGAAGACACUGAGACACCAAUUGACACCACCAUCAUGGCAAAAAAUGAGGUUUUCUGCGUCCAACCAGAGAAGGGGGGCCGCAAGCCAGCUCGCCUUAUCGUAUUCCCAGAUUUGGGGGUUCGUGUGUGCGAGAAAAUGGCCCUUUACGAUGUGGUCUCCACCCUCCCUCAGGCCGUGAUGGGCUCUUCAUACGGAUUCCAAUACUCUCCUGGACAGCGGGUCGAGUUCCUGGUGAAUGCCUGGAAAGCGAAGAAAUGCCCUAUGGGCUUCGCAUAUGACACCCGCUGUUUUGACUCAACGGUCACUGAGAAUGACAUCCGUGUUGAGGAGUCAAUCUACCAAUGUUGUGACUUGGCCCCCGAAGCCAGACAGGCCAUAAGGUCGCUCACAGAGCGGCUUUACAUCGGGGGCCCCCUGACUAAUUCUAAAGGGCAGAACUGCGGCUAUCGCCGGUGCCGCGCGAGCGGUGUACUGACGACCAGCUGCGGUAAUACCCUCACAUGUUACUUGAAGGCCGCUGCGGCCUGUCGAGCUGCGAAGCUCCAGGACUGCACGAUGCUCGUAUGCGGAGACGACCUUGUCGUUAUCUGUGAAAGCGCGGGGACCCAAGAGGACGAGGCGAGCCUACGGGCCUUCACGGAGGCUAUGACUAGAUACUCUGCCCCCCCUGGGGACCCGCCCAAACCAGAAUACGACUUGGAGUUGAUAACAUCAUGCUCCUCCAAUGUGUCAGUCGCGCACGAUGCAUCUGGCAAAAGGGUGUACUAUCUCACCCGUGACCCCACCACCCCCCUUGCGCGGGCUGCGUGGGAGACAGCUAGACACACUCCAGUCAAUUCCUGGCUAGGCAACAUCAUCAUGUAUGCGCCCACCUUGUGGGCAAGGAUGAUCCUGAUGACUCAUUUCUUCUCCAUCCUUCUAGCUCAGGAACAACUUGAAAAAGCCCUAGAUUGUCAGAUCUACGGGGCCUGUUACUCCAUUGAGCCACUUGACCUACCUCAGAUCAUUCAACGACUCCAUGGCCUUAGCGCAUUUUCACUCCAUAGUUACUCUCCAGGUGAGAUCAAUAGGGUGGCUUCAUGCCUCAGGAAACUUGGGGUACCGCCCUUGCGAGUCUGGAGACAUCGGGCCAGAAGUGUCCGCGCUAGGCUACUGUCCCAGGGGGGGAGGGCUGCCACUUGUGGCAAGUACCUCUUCAACUGGGCAGUAAGGACCAAGCUCAAACUCACUCCAAUCCCGGCUGCGUCCCAGUUGGAUUUAUCCAGCUGGUUCGUUGCUGGUUACAGCGGGGGAGACAUAUAUCACAGCCUGUCUCGUGCCCGACCCCGCUGGUUCAUGUGGUGCCUACUCCUACUUUCUGUAGGGGUAGGCAUCUAUCUACUCCCCAACCGAUGAACGGGGACCUAAACACUCCAGGCCAAUAGGCCAUCCUGUUUUUUUCCCUUUUUUUUUUUCUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUCUCCUUUUUUUUUCCUCUUUUUUUCCUUUUCUUUCCUUUGGUGGCUCCAUCUUAGCCCUAGUCACGGCUAGCUGUGAAAGGUCCGUGAGCCGCUUGACUGCAGAGAGUGCUGAUACUGGCCUCUCUGCAGAUCAAGU";
			one.findPosition(genome);
			System.out.println (one.getPosition ());
			one.setPosition (0);
			System.out.println (one.getPosition ());
	}
}
